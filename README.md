# PasteMD
<p align="center">
  <img src="assets/icons/logo.png" alt="PasteMD" width="160" height="160">
</p>

<p align="center">
  <a href="https://github.com/RICHQAQ/PasteMD/releases">
    <img src="https://img.shields.io/github/v/release/RICHQAQ/PasteMD?sort=semver&label=Release&style=flat-square&logo=github" alt="Release">
  </a>
  <a href="https://github.com/RICHQAQ/PasteMD/releases">
    <img src="https://img.shields.io/github/downloads/RICHQAQ/PasteMD/total?label=Downloads&style=flat-square&logo=github" alt="Downloads">
  </a>
  <a href="LICENSE">
    <img src="https://img.shields.io/github/license/RICHQAQ/PasteMD?style=flat-square" alt="License">
  </a>
  <img src="https://img.shields.io/badge/Python-3.12%2B-3776AB?style=flat-square&logo=python&logoColor=white" alt="Python 3.12+">
  <img src="https://img.shields.io/badge/Platform-Windows%20%7C%20Word%20%7C%20WPS-5e8d36?style=flat-square&logo=windows&logoColor=white" alt="Platform">
</p>

<p align="center"> 
  <a href="docs/md/README.en.md">English</a>
  |
  <a href="README.md">ç®€ä½“ä¸­æ–‡</a>
  |
  <a href="docs/md/README.ja.md">æ—¥æœ¬èª</a>
</p>

> åœ¨å†™è®ºæ–‡æˆ–æŠ¥å‘Šæ—¶ï¼Œä» ChatGPT / DeepSeek ç­‰ AI ç½‘ç«™ä¸­å¤åˆ¶å‡ºæ¥çš„å…¬å¼åœ¨ Word é‡Œæ€»æ˜¯ä¹±ç ï¼ŸMarkdown è¡¨æ ¼å¤åˆ¶åˆ° Excel æ€»æ˜¯ä¸è¡Œï¼Ÿ**PasteMD å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œç”Ÿçš„ï¼Œå˜¿å˜¿**
> 
> <img src="docs/gif/atri/igood.gif"
     alt="æˆ‘å¯æ˜¯é«˜æ€§èƒ½çš„"
     width="100">

ä¸€ä¸ªå¸¸é©»æ‰˜ç›˜çš„å°å·¥å…·ï¼š
ä» **å‰ªè´´æ¿è¯»å– Markdown**ï¼Œè°ƒç”¨ **Pandoc** è½¬æ¢ä¸º DOCXï¼Œå¹¶è‡ªåŠ¨æ’å…¥åˆ° **Word/WPS** å…‰æ ‡ä½ç½®ã€‚

**âœ¨ åŠŸèƒ½**ï¼šæ™ºèƒ½è¯†åˆ« Markdown è¡¨æ ¼ï¼Œä¸€é”®ç²˜è´´åˆ° **Excel**ï¼

**âœ¨ åŠŸèƒ½**ï¼šæ™ºèƒ½è¯†åˆ« HTMLå¯Œæ–‡æœ¬ï¼Œæ–¹ä¾¿ç›´æ¥å¤åˆ¶ç½‘é¡µä¸Šçš„aiå›å¤ï¼Œä¸€é”®ç²˜è´´åˆ° **Word/WPS**ï¼

**âœ¨ æ–°åŠŸèƒ½**ï¼šåº”ç”¨æ‰©å±•ï¼ˆHTML+Markdown/HTML/Markdown/LaTeX/æ–‡ä»¶ç²˜è´´ï¼‰ï¼Œå¯æŒ‰åº”ç”¨/çª—å£æ ‡é¢˜åŒ¹é…ï¼ˆå¦‚è¯­é›€/QQç­‰ï¼‰ã€‚

**âœ¨ æ–°åŠŸèƒ½**ï¼šè½¬æ¢å¢å¼ºï¼šæ”¯æŒæŒ‰è½¬æ¢ç±»å‹é…ç½® Pandoc Filtersï¼›è‡ªåŠ¨ä¿®å¤éƒ¨åˆ† LaTeX è¯­æ³•ä¸å• `$...$` å…¬å¼å—ã€‚

---

## åŠŸèƒ½ç‰¹ç‚¹

### æ¼”ç¤ºæ•ˆæœ

#### Markdown â†’ Word/WPS

<p align="center">
  <img src="docs/gif/demo.gif" alt="æ¼”ç¤ºåŠ¨å›¾" width="600">
</p>

#### å¤åˆ¶ç½‘é¡µä¸­çš„aiå›å¤ â†’ Word/WPS
<p align="center">
  <img src="docs/gif/demo-html.gif" alt="æ¼”ç¤ºHTMLåŠ¨å›¾" width="600">
</p>

#### Markdown è¡¨æ ¼ â†’ Excel
<p align="center">
  <img src="docs/gif/demo-excel.gif" alt="æ¼”ç¤ºExcelåŠ¨å›¾" width="600">
</p>

#### è®¾ç½®æ ¼å¼
<p align="center">
  <img src="docs/gif/demo-chage_format.gif" alt="æ¼”ç¤ºè®¾ç½®æ ¼å¼åŠ¨å›¾" width="600">
</p>


* å…¨å±€çƒ­é”®ï¼ˆé»˜è®¤ `Ctrl+Shift+B`ï¼‰ä¸€é”®ç²˜è´´ Markdown â†’ DOCXã€‚
* **âœ¨ æ™ºèƒ½è¯†åˆ« Markdown è¡¨æ ¼**ï¼Œè‡ªåŠ¨ç²˜è´´åˆ° Excelã€‚
* **âœ¨ åº”ç”¨æ‰©å±•**ï¼šä¸ºä¸åŒåº”ç”¨é…ç½® HTML+Markdown/HTML/Markdown/LaTeX/æ–‡ä»¶ ç²˜è´´æ¨¡å¼ï¼Œæ”¯æŒæŒ‰çª—å£æ ‡é¢˜åŒ¹é…ã€‚
* **âœ¨ è½¬æ¢å¢å¼º**ï¼šæŒ‰è½¬æ¢ç±»å‹æ·»åŠ  Pandoc Filtersï¼Œè‡ªåŠ¨ä¿®å¤éƒ¨åˆ† LaTeX è¯­æ³•ä¸å• `$...$` å…¬å¼å—ã€‚
* è‡ªåŠ¨è¯†åˆ«å½“å‰å‰å°åº”ç”¨ï¼šWord æˆ– WPSã€‚
* æ™ºèƒ½æ‰“å¼€æ‰€éœ€åº”ç”¨ä¸ºWord/Excelã€‚
* æ‰˜ç›˜èœå•ï¼Œå¯ä¿ç•™æ–‡ä»¶ã€æŸ¥çœ‹æ—¥å¿—/é…ç½®ç­‰ã€‚
* æ”¯æŒç³»ç»Ÿé€šçŸ¥æé†’ã€‚
* æ— é»‘æ¡†ï¼Œæ— é˜»å¡ï¼Œç¨³å®šè¿è¡Œã€‚

---

## ğŸ“Š AI ç½‘ç«™å…¼å®¹æ€§æµ‹è¯•

ä»¥ä¸‹æ˜¯ä¸»æµ AI å¯¹è¯ç½‘ç«™çš„å¤åˆ¶ç²˜è´´å…¼å®¹æ€§æµ‹è¯•ç»“æœï¼š

| AI ç½‘ç«™ | å¤åˆ¶ Markdown<br/>ï¼ˆæ— å…¬å¼ï¼‰ | å¤åˆ¶ Markdown<br/>ï¼ˆå«å…¬å¼ï¼‰ | å¤åˆ¶ç½‘é¡µå†…å®¹<br/>ï¼ˆæ— å…¬å¼ï¼‰ | å¤åˆ¶ç½‘é¡µå†…å®¹<br/>ï¼ˆå«å…¬å¼ï¼‰ |
|---------|:----------------------------:|:----------------------------:|:---------------------------:|:---------------------------:|
| **Kimi** | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âš ï¸ æ— æ³•æ˜¾ç¤ºå…¬å¼ |
| **DeepSeek** | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ |
| **é€šä¹‰åƒé—®** | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âš ï¸ æ— æ³•æ˜¾ç¤ºå…¬å¼ |
| **è±†åŒ…\*** | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ |
| **æ™ºè°±æ¸…è¨€<br/>/ChatGLM** | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ |
| **ChatGPT** | âœ… å®Œç¾æ”¯æŒ | âš ï¸ å…¬å¼æ˜¾ç¤ºä¸ºä»£ç  | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ |
| **Gemini** | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ |
| **Grok** | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ |
| **Claude** | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ | âœ… å®Œç¾æ”¯æŒ |

**å›¾ä¾‹è¯´æ˜ï¼š**
- âœ… **å®Œç¾æ”¯æŒ**ï¼šæ ¼å¼ã€æ ·å¼ã€å…¬å¼ä¼šå‡æ­£ç¡®æ˜¾ç¤º
- âš ï¸ **å…¬å¼æ˜¾ç¤ºä¸ºä»£ç **ï¼šæ•°å­¦å…¬å¼ä¼šä»¥ LaTeX ä»£ç å½¢å¼æ˜¾ç¤ºï¼Œéœ€åœ¨ Word/WPS ä¸­æ‰‹åŠ¨ä½¿ç”¨å…¬å¼ç¼–è¾‘å™¨
- âš ï¸ **æ— æ³•æ˜¾ç¤ºå…¬å¼**ï¼šæ•°å­¦å…¬å¼ä¼šä¸¢å¤±ï¼Œéœ€åœ¨ Word/WPS ä¸­æ‰‹åŠ¨ä½¿ç”¨å…¬å¼ç¼–è¾‘å™¨ï¼Œè‡ªè¡Œè¾“å…¥å…¬å¼å†…å®¹
- **è±†åŒ…**ï¼šå¤åˆ¶ç½‘é¡µå†…å®¹ï¼ˆå«å…¬å¼ï¼‰å‰ï¼Œéœ€è¦åœ¨æµè§ˆå™¨ä¸­å¼€å¯â€œå…è®¸è¯»å–å‰ªè´´æ¿â€æƒé™ï¼Œå¯åœ¨ URL åœ°å€æ å·¦ä¾§çš„å›¾æ ‡ä¸­è¿›è¡Œè®¾ç½®

**æµ‹è¯•è¯´æ˜ï¼š**
1. **å¤åˆ¶ Markdown**ï¼šç‚¹å‡» AI å›å¤ä¸­çš„"å¤åˆ¶"æŒ‰é’®ï¼ˆé€šå¸¸å¤åˆ¶çš„æ˜¯ Markdown æ ¼å¼ï¼Œä½†æ˜¯éƒ¨åˆ†ç½‘ç«™ä¹Ÿä¼šæºå¸¦ä¸Šhtmlï¼‰
2. **å¤åˆ¶ç½‘é¡µå†…å®¹**ï¼šç›´æ¥é€‰ä¸­ AI å›å¤å†…å®¹è¿›è¡Œå¤åˆ¶ï¼ˆå¤åˆ¶çš„æ˜¯ HTML å¯Œæ–‡æœ¬ï¼‰

---

## ğŸš€ä½¿ç”¨æ–¹æ³•

1. ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ[Releases é¡µé¢](https://github.com/RICHQAQ/PasteMD/releases/)ï¼‰ï¼š

   * ~~**PasteMD\_vx.x.x.exe**ï¼š**ä¾¿æºç‰ˆ**ï¼Œéœ€è¦ä½ æœ¬æœºå·²ç»å®‰è£…å¥½ **Pandoc** å¹¶èƒ½åœ¨å‘½ä»¤è¡Œè¿è¡Œã€‚
   è‹¥æœªå®‰è£…ï¼Œè¯·åˆ° [Pandoc å®˜ç½‘](https://pandoc.org/installing.html) ä¸‹è½½å®‰è£…å³å¯ã€‚~~ ï¼ˆä¸å†æä¾›ï¼Œéœ€è¦è¯·è‡ªè¡Œç¼–è¯‘ï¼‰
   * **PasteMD\_pandoc-Setup.exe**ï¼š**ä¸€ä½“åŒ–å®‰è£…åŒ…**ï¼Œè‡ªå¸¦ Pandocï¼Œä¸éœ€è¦å¦å¤–é…ç½®ç¯å¢ƒã€‚

2. æ‰“å¼€ Wordã€WPS æˆ– Excelï¼Œå…‰æ ‡æ”¾åœ¨éœ€è¦æ’å…¥çš„ä½ç½®ã€‚

3. å¤åˆ¶ **Markdown** æˆ–è€… **ç½‘é¡µå†…å®¹** åˆ°å‰ªè´´æ¿ï¼ŒæŒ‰ä¸‹çƒ­é”® **Ctrl+Shift+B**ã€‚

4. è½¬æ¢ç»“æœä¼šè‡ªåŠ¨æ’å…¥åˆ°æ–‡æ¡£ä¸­ï¼š
   - **Markdown è¡¨æ ¼** â†’ è‡ªåŠ¨ç²˜è´´åˆ° Excelï¼ˆå¦‚æœ Excel å·²æ‰“å¼€ï¼‰
   - **æ™®é€š Markdown**/**ç½‘é¡µå†…å®¹** â†’ è½¬æ¢ä¸º DOCX å¹¶æ’å…¥ Word/WPS

5. å³ä¸‹è§’ä¼šæç¤ºæˆåŠŸ/å¤±è´¥ã€‚

---

## âš™ï¸é…ç½®

é¦–æ¬¡è¿è¡Œä¼šåœ¨ç”¨æˆ·æ•°æ®ç›®å½•ç”Ÿæˆ `config.json`ï¼ˆWindowsï¼š`%APPDATA%\\PasteMD\\config.json`ï¼Œ MacOS: `~/Library/Application Support/PasteMD/config.json`ï¼‰ï¼Œå¯æ‰‹åŠ¨ç¼–è¾‘ï¼š

```json
{
  "hotkey": "<ctrl>+<shift>+b",
  "pandoc_path": "pandoc",
  "reference_docx": null,
  "save_dir": "%USERPROFILE%\\Documents\\pastemd",
  "keep_file": false,
  "notify": true,
  "startup_notify": true,
  "enable_excel": true,
  "excel_keep_format": true,
  "paste_delay_s": 0.3,
  "no_app_action": "open",
  "md_disable_first_para_indent": true,
  "html_disable_first_para_indent": true,
  "html_formatting": {
    "strikethrough_to_del": true
  },
  "move_cursor_to_end": true,
  "Keep_original_formula": false,
  "enable_latex_replacements": true,
  "fix_single_dollar_block": true,
  "language": "zh-CN",
  "pandoc_request_headers": [
    "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
  ],
  "pandoc_filters": [],
  "pandoc_filters_by_conversion": {
    "md_to_docx": [],
    "html_to_docx": [],
    "html_to_md": [],
    "md_to_html": [],
    "md_to_rtf": [],
    "md_to_latex": []
  },
  "extensible_workflows": {
    "html": {
      "enabled": true,
      "apps": [],
      "keep_formula_latex": true
    },
    "md": {
      "enabled": true,
      "apps": [],
      "html_formatting": {
        "css_font_to_semantic": true,
        "bold_first_row_to_header": true
      }
    },
    "latex": {
      "enabled": true,
      "apps": []
    },
    "file": {
      "enabled": true,
      "apps": []
    }
  }
}
```

å­—æ®µè¯´æ˜ï¼š

* `hotkey`ï¼šå…¨å±€çƒ­é”®ï¼Œè¯­æ³•å¦‚ `<ctrl>+<alt>+v`ã€‚
* `pandoc_path`ï¼šPandoc å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ã€‚
* `reference_docx`ï¼šPandoc å‚è€ƒæ¨¡æ¿ï¼ˆå¯é€‰ï¼‰ã€‚
* `save_dir`ï¼šä¿ç•™æ–‡ä»¶æ—¶çš„ä¿å­˜ç›®å½•ã€‚
* `keep_file`ï¼šæ˜¯å¦ä¿ç•™ç”Ÿæˆçš„ DOCX æ–‡ä»¶ã€‚
* `notify`ï¼šæ˜¯å¦æ˜¾ç¤ºç³»ç»Ÿé€šçŸ¥ã€‚
* `startup_notify`ï¼šå¯åŠ¨æ—¶æ˜¯å¦æ˜¾ç¤ºæç¤ºé€šçŸ¥ã€‚
* **`enable_excel`**ï¼š - æ˜¯å¦å¯ç”¨æ™ºèƒ½è¯†åˆ« Markdown è¡¨æ ¼å¹¶ç²˜è´´åˆ° Excelï¼ˆé»˜è®¤ trueï¼‰ã€‚
* **`excel_keep_format`**ï¼š - Excel ç²˜è´´æ—¶æ˜¯å¦ä¿ç•™ Markdown æ ¼å¼ï¼ˆç²—ä½“ã€æ–œä½“ã€ä»£ç ç­‰ï¼‰ï¼Œé»˜è®¤ trueã€‚
* `paste_delay_s`ï¼šç²˜è´´å‰çš„å»¶è¿Ÿç§’æ•°ï¼ˆwinæœ‰çš„æ—¶å€™å†™å…¥å‰ªåˆ‡æ¿éœ€è¦ä¸€ç‚¹ç‚¹æ—¶é—´ï¼‰ã€‚
* **`no_app_action`**ï¼š å½“æœªæ£€æµ‹åˆ°ç›®æ ‡åº”ç”¨ï¼ˆå¦‚ Word/Excelï¼‰æ—¶çš„é»˜è®¤åŠ¨ä½œï¼ˆé»˜è®¤ `"open"`ï¼‰ã€‚å¯é€‰å€¼ï¼š`open`=è‡ªåŠ¨æ‰“å¼€ã€`save`=ä»…ä¿å­˜ã€`clipboard`=å¤åˆ¶æ–‡ä»¶åˆ°å‰ªè´´æ¿ã€`none`=æ— æ“ä½œã€‚
* **`md_disable_first_para_indent`**ï¼š - Markdown è½¬æ¢æ—¶æ˜¯å¦ç¦ç”¨ç¬¬ä¸€æ®µçš„ç‰¹æ®Šæ ¼å¼ï¼Œç»Ÿä¸€ä¸ºæ­£æ–‡æ ·å¼ï¼ˆé»˜è®¤ trueï¼‰ã€‚
* **`html_formatting`**ï¼š - HTML å¯Œæ–‡æœ¬è½¬æ¢æ—¶çš„æ ¼å¼åŒ–é€‰é¡¹ã€‚
  * **`strikethrough_to_del`**ï¼š - æ˜¯å¦å°†åˆ é™¤çº¿ ~~ è½¬æ¢ä¸º `<del>` æ ‡ç­¾ï¼Œä½¿å¾—è½¬æ¢æ­£ç¡®ï¼ˆé»˜è®¤ trueï¼‰ã€‚
* **`html_disable_first_para_indent`**ï¼š - HTML å¯Œæ–‡æœ¬è½¬æ¢æ—¶æ˜¯å¦ç¦ç”¨ç¬¬ä¸€æ®µçš„ç‰¹æ®Šæ ¼å¼ï¼Œç»Ÿä¸€ä¸ºæ­£æ–‡æ ·å¼ï¼ˆé»˜è®¤ trueï¼‰ã€‚
* **`move_cursor_to_end`**ï¼š - æ’å…¥å†…å®¹åæ˜¯å¦å°†å…‰æ ‡ç§»åŠ¨åˆ°æ’å…¥å†…å®¹çš„æœ«å°¾ï¼ˆé»˜è®¤ trueï¼‰ã€‚
* **`Keep_original_formula`**ï¼š - æ˜¯å¦ä¿ç•™åŸå§‹æ•°å­¦å…¬å¼ï¼ˆLaTeX ä»£ç å½¢å¼ï¼‰ã€‚
* `enable_latex_replacements`ï¼šè‡ªåŠ¨ä¿®å¤éƒ¨åˆ†ä¸å…¼å®¹çš„ LaTeX è¯­æ³•ï¼ˆä¾‹å¦‚å°† `{\\kern 10pt}` æ›¿æ¢ä¸º `\\qquad`ï¼‰ã€‚
* `fix_single_dollar_block`ï¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä¿®å¤å•ç‹¬ä¸€è¡Œçš„ `$ ... $` å…¬å¼å—ï¼ˆè½¬æ¢ä¸º `$$ ... $$`ï¼‰ã€‚
* `language`ï¼šç•Œé¢è¯­è¨€ï¼Œ`zh-CN` ç®€ä½“ä¸­æ–‡ï¼Œ`en-US` è‹±æ–‡ï¼Œ`ja-JP` æ—¥è¯­ã€‚
* `pandoc_request_headers`ï¼šPandoc ä¸‹è½½è¿œç¨‹èµ„æºæ—¶é™„åŠ çš„è¯·æ±‚å¤´ï¼ˆæ¯è¡Œä¸€ä¸ª `Header: Value`ï¼‰ã€‚
* **`pandoc_filters`**ï¼š - è‡ªå®šä¹‰ Pandoc Filter åˆ—è¡¨ã€‚å¯æ·»åŠ  `.lua` è„šæœ¬æˆ–å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼ŒFilter å°†æŒ‰ç…§åˆ—è¡¨é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ç”¨äºæ‰©å±• Pandoc è½¬æ¢åŠŸèƒ½ï¼Œå¦‚è‡ªå®šä¹‰æ ¼å¼å¤„ç†ã€ç‰¹æ®Šè¯­æ³•è½¬æ¢ç­‰ã€‚é»˜è®¤ä¸ºç©ºåˆ—è¡¨ã€‚ç¤ºä¾‹ï¼š`["%APPDATA%\\npm\\mermaid-filter.cmd"]` å¯å®ç° Mermaid å›¾è¡¨æ”¯æŒã€‚
* `pandoc_filters_by_conversion`ï¼šæŒ‰è½¬æ¢ç±»å‹é…ç½® Filtersï¼ˆå¦‚ `md_to_docx`ã€`html_to_md` ç­‰ï¼‰ã€‚
* `extensible_workflows`ï¼šåº”ç”¨æ‰©å±•é…ç½®ï¼ˆæŒ‰åº”ç”¨/çª—å£æ ‡é¢˜åŒ¹é…ä¸åŒç²˜è´´æ¨¡å¼ï¼‰ï¼Œè¯¦æƒ…è§ä¸‹æ–‡ã€‚

ä¿®æ”¹åå¯åœ¨æ‰˜ç›˜èœå•é€‰æ‹© **â€œé‡è½½é…ç½®/çƒ­é”®â€** ç«‹å³ç”Ÿæ•ˆã€‚

---

## ğŸ”§ é«˜çº§åŠŸèƒ½ï¼šè‡ªå®šä¹‰ Pandoc Filters

### ä»€ä¹ˆæ˜¯ Pandoc Filterï¼Ÿ

Pandoc Filter æ˜¯åœ¨æ–‡æ¡£è½¬æ¢è¿‡ç¨‹ä¸­å¯¹å†…å®¹è¿›è¡Œè‡ªå®šä¹‰å¤„ç†çš„æ’ä»¶ç¨‹åºã€‚PasteMD æ”¯æŒé…ç½®å¤šä¸ª Filterï¼ŒæŒ‰é¡ºåºä¾æ¬¡å¤„ç†æ–‡æ¡£å†…å®¹ï¼Œå®ç°æ‰©å±•åŠŸèƒ½ã€‚

### ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šMermaid å›¾è¡¨æ”¯æŒ

å¦‚æœæ‚¨æƒ³åœ¨ Markdown ä¸­ä½¿ç”¨ Mermaid å›¾è¡¨å¹¶æ­£ç¡®è½¬æ¢åˆ° Wordï¼Œå¯ä»¥ä½¿ç”¨ [mermaid-filter](https://github.com/raghur/mermaid-filter)ã€‚

**1. å®‰è£… mermaid-filter**

```bash
npm install --global mermaid-filter
```

*å‰ç½®æ¡ä»¶ï¼šéœ€è¦å…ˆå®‰è£… [Node.js](https://nodejs.org/)*

<details>
<summary>âš ï¸ <b>æ•…éšœæ’é™¤ï¼šChrome ä¸‹è½½å¤±è´¥</b></summary>

å®‰è£… mermaid-filter æ—¶éœ€è¦ä¸‹è½½ Chromium æµè§ˆå™¨ã€‚å¦‚æœè‡ªåŠ¨ä¸‹è½½å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨ä¸‹è½½ï¼š

**æ­¥éª¤ 1ï¼šæŸ¥æ‰¾æ‰€éœ€çš„ Chromium ç‰ˆæœ¬å·**

æŸ¥çœ‹æ–‡ä»¶ï¼š`%APPDATA%\npm\node_modules\mermaid-filter\node_modules\puppeteer-core\lib\cjs\puppeteer\revisions.d.ts`

æ‰¾åˆ°ç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š
```typescript
chromium: "1108766";
```

æˆ–åœ¨æŠ¥é”™ä¿¡æ¯é‡Œï¼Œå¦‚ï¼š
```bash
npm error Error: Download failed: server returned code 502. URL: https://npmmirror.com/mirrors/chromium-browser-snapshots/Win_x64/1108766/chrome-win.zip
```
æ‰¾åˆ°ç±»ä¼¼ `Win_x64/1108766` çš„ç‰ˆæœ¬å·ã€‚

è®°ä¸‹è¿™ä¸ªç‰ˆæœ¬å·ï¼ˆä¾‹å¦‚ï¼š`1108766`ï¼‰ã€‚

**æ­¥éª¤ 2ï¼šä¸‹è½½ Chromium**

æ ¹æ®ä¸Šä¸€æ­¥è·å–çš„ç‰ˆæœ¬å·ï¼Œä¸‹è½½å¯¹åº”çš„ Chromiumï¼š

```
https://storage.googleapis.com/chromium-browser-snapshots/Win_x64/1108766/chrome-win.zip
```

ï¼ˆå°† URL ä¸­çš„ `1108766` æ›¿æ¢ä¸ºä½ æŸ¥åˆ°çš„ç‰ˆæœ¬å·ï¼‰

**æ­¥éª¤ 3ï¼šè§£å‹åˆ°æŒ‡å®šç›®å½•**

å°†ä¸‹è½½çš„ `chrome-win.zip` è§£å‹åˆ°ä»¥ä¸‹ç›®å½•ï¼š

```
%USERPROFILE%\.cache\puppeteer\chrome\win64-1108766\chrome-win
```

ï¼ˆç›®å½•ä¸­çš„ `1108766` ä¹Ÿéœ€è¦æ›¿æ¢ä¸ºä½ çš„ç‰ˆæœ¬å·ï¼‰

è§£å‹åï¼Œåº”è¯¥æœ‰ `chrome.exe` ä½äºï¼š  
`%USERPROFILE%\.cache\puppeteer\chrome\win64-1108766\chrome-win\chrome.exe`

</details>

**2. é…ç½®åˆ° PasteMD**

æ–¹å¼ä¸€ï¼šé€šè¿‡è®¾ç½®ç•Œé¢
- æ‰“å¼€ PasteMD è®¾ç½® â†’ è½¬æ¢é€‰é¡¹å¡ â†’ Pandoc Filters
- ç‚¹å‡»ã€Œæ·»åŠ ...ã€æŒ‰é’®
- é€‰æ‹© Filter æ–‡ä»¶ï¼š`%APPDATA%\npm\mermaid-filter.cmd`
- ä¿å­˜è®¾ç½®

æ–¹å¼äºŒï¼šç¼–è¾‘é…ç½®æ–‡ä»¶
```json
{
  "pandoc_filters": [
    "%APPDATA%\\npm\\mermaid-filter.cmd"
  ]
}
```

**3. æµ‹è¯•æ•ˆæœ**

å¤åˆ¶ä»¥ä¸‹ Markdown å†…å®¹å¹¶ä½¿ç”¨ PasteMD è½¬æ¢ï¼š

~~~markdown
```mermaid
graph LR
    A[å¼€å§‹] --> B[å¤„ç†]
    B --> C[ç»“æŸ]
```
~~~

Mermaid å›¾è¡¨å°†è¢«æ¸²æŸ“ä¸ºå›¾ç‰‡å¹¶æ’å…¥åˆ° Word æ–‡æ¡£ä¸­ã€‚

### æ›´å¤š Filter èµ„æº

- [Pandoc Filters å®˜æ–¹åˆ—è¡¨](https://github.com/jgm/pandoc/wiki/Pandoc-Filters)
- [Lua Filters æ–‡æ¡£](https://pandoc.org/lua-filters.html)

---

## ğŸ§© åº”ç”¨æ‰©å±•ï¼ˆè‡ªå®šä¹‰ç²˜è´´å·¥ä½œæµï¼‰

è®¾ç½® â†’ **åº”ç”¨æ‰©å±•** ä¸­å¯ä»¥ä¸ºä¸åŒåº”ç”¨é…ç½®ç²˜è´´æ¨¡å¼ï¼Œæ”¯æŒæŒ‰çª—å£æ ‡é¢˜æ­£åˆ™åŒ¹é…ï¼š

* **HTML** / **Markdown** / **LaTeX** / **æ–‡ä»¶**ï¼šæŒ‰ç›®æ ‡åº”ç”¨é€‰æ‹©æœ€åˆé€‚çš„ç²˜è´´æ–¹å¼
  - HTMLã€Markdown é€‚åˆè¯­é›€ç­‰å¯Œæ–‡æœ¬ç¬”è®°è½¯ä»¶
  - LaTeX é€‚åˆoverleafç­‰å­¦æœ¯ç½‘ç«™
  - æ–‡ä»¶ é€‚åˆQQã€å¾®ä¿¡ç­‰ä½œä¸ºé™„ä»¶ç²˜è´´çš„åº”ç”¨

> æç¤ºï¼šåŒä¸€ä¸ªåº”ç”¨åªå»ºè®®é…ç½®ä¸€ç§å·¥ä½œæµï¼ˆé¿å…å†²çªï¼‰ï¼›éœ€è¦åŒºåˆ†çª—å£æ ‡é¢˜æ—¶å¯ä½¿ç”¨â€œçª—å£åç§°åŒ¹é…â€ã€‚

ç¤ºä¾‹é…ç½®ï¼ˆèŠ‚é€‰ï¼‰ï¼š

> Windows ä¸‹ `id` é€šå¸¸ä¸ºåº”ç”¨çš„ exe è·¯å¾„ï¼›macOS ä¸ºåº”ç”¨çš„ bundle idï¼ˆå»ºè®®é€šè¿‡è®¾ç½®ç•Œé¢æ·»åŠ ï¼Œè‡ªåŠ¨å¡«å……ï¼‰ã€‚

```json
{
  "extensible_workflows": {
    "html": {
      "enabled": true,
      "apps": [
        {
          "name": "è¯­é›€",
          "id": "/path/è¯­é›€.exe",
          "window_patterns": []
        }
      ],
      "keep_formula_latex": true
    },
    "latex": {
      "enabled": true,
      "apps": [
        {
          "name": "chrome",
          "id": "/path/chrome.exe",
          "window_patterns": [
            ".*overleaf.*"
          ]
        }
      ]
    },
    "file": {
      "enabled": true,
      "apps": [
        {
          "name": "QQ",
          "id": "/path/qq.exe",
          "window_patterns": []
        }
      ]
    }
  }
}
```

---

## æ‰˜ç›˜èœå•

* å¿«æ·æ˜¾ç¤ºï¼šå½“å‰å…¨å±€çƒ­é”®ï¼ˆåªè¯»ï¼‰ã€‚
* å¯ç”¨çƒ­é”®ï¼šå¼€/å…³å…¨å±€çƒ­é”®ã€‚
* å¼¹çª—é€šçŸ¥ï¼šå¼€/å…³ç³»ç»Ÿé€šçŸ¥ã€‚
* æ— åº”ç”¨æ—¶åŠ¨ä½œï¼šå½“æœªæ£€æµ‹åˆ° Word/WPS/Excel æ—¶çš„é»˜è®¤åŠ¨ä½œï¼ˆè‡ªåŠ¨æ‰“å¼€/ä»…ä¿å­˜/å¤åˆ¶åˆ°å‰ªè´´æ¿/æ— æ“ä½œï¼‰ã€‚
* æ’å…¥åç§»åŠ¨å…‰æ ‡åˆ°æœ«å°¾ï¼šæ’å…¥å†…å®¹åæ˜¯å¦å°†å…‰æ ‡ç§»åŠ¨åˆ°æ’å…¥å†…å®¹çš„æœ«å°¾ã€‚
* HTML æ ¼å¼åŒ–ï¼šåˆ‡æ¢ **åˆ é™¤çº¿ ~~ è½¬æ¢ä¸º `<del>`** ç­‰ HTML è‡ªåŠ¨æ•´ç†ï¼Œä½¿å¾—å¯ä»¥æ­£ç¡®è½¬æ¢ï¼ˆé˜²æ­¢éƒ¨åˆ†ç½‘é¡µæ²¡æœ‰è§£æè¿™äº›æ ¼å¼ï¼Œå¯¼è‡´ä»ç½‘é¡µå¤åˆ¶ç²˜è´´æ— æ³•æ˜¾ç¤ºè¿™äº›æ ¼å¼ï¼‰ã€‚
* è®¾ç½®çƒ­é”®ï¼šé€šè¿‡å›¾å½¢ç•Œé¢å½•åˆ¶å¹¶ä¿å­˜æ–°çš„å…¨å±€çƒ­é”®ï¼ˆå³æ—¶ç”Ÿæ•ˆï¼‰ã€‚
* ä¿ç•™ç”Ÿæˆæ–‡ä»¶ï¼šå‹¾é€‰åç”Ÿæˆçš„ DOCX ä¼šä¿å­˜åœ¨ `save_dir`ã€‚
* æ‰“å¼€ä¿å­˜ç›®å½•ã€æŸ¥çœ‹æ—¥å¿—ã€ç¼–è¾‘é…ç½®ã€é‡è½½é…ç½®/çƒ­é”®ã€‚
* ç‰ˆæœ¬ï¼šæ˜¾ç¤ºå½“å‰ç‰ˆæœ¬ï¼›å¯æ£€æŸ¥æ›´æ–°ï¼›è‹¥æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬ï¼Œä¼šæ˜¾ç¤ºæ¡ç›®å¹¶å¯ç‚¹å‡»æ‰“å¼€ä¸‹è½½é¡µé¢ã€‚
* é€€å‡ºï¼šé€€å‡ºç¨‹åºã€‚

---

## ğŸ“¦ä»æºç è¿è¡Œ / æ‰“åŒ…

å»ºè®® Python 3.12 (64ä½)ã€‚

```bash
pip install -r requirements.txt
python main.py
```

ä½¿ç”¨ PyInstallerï¼š

```bash
pyinstaller --clean -F -w -n PasteMD
  --icon assets\icons\logo.ico
  --add-data "assets\icons;assets\icons"
  --add-data "pastemd\i18n\locales\*.json;pastemd\i18n\locales"
  --add-data "pastemd\lua;pastemd\lua"
  --hidden-import plyer.platforms.win.notification
  main.py
```

ç”Ÿæˆçš„ç¨‹åºåœ¨ `dist/PasteMD.exe`ã€‚

---

## â­ Star 

æ„Ÿè°¢æ¯ä¸€ä½ Star çš„å¸®åŠ©ï¼Œæ¬¢è¿åˆ†äº«ç»™æ›´å¤šå°ä¼™ä¼´~ï¼Œæƒ³è¦è¾¾æˆ4096 starğŸŒŸï¼Œæˆ‘ä¼šåŠªåŠ›çš„å–µ

<img src="docs/gif/atri/likeyou.gif"
     alt="å–œæ¬¢ä½ "
     width="150">

[![Star History Chart](https://api.star-history.com/svg?repos=RICHQAQ/PasteMD&type=date&legend=top-left)](https://www.star-history.com/#RICHQAQ/PasteMD&type=date&legend=top-left)

## ğŸµæ”¯æŒä¸æ‰“èµ

å¦‚æœæœ‰ä»€ä¹ˆæƒ³æ³•å’Œå¥½å»ºè®®ï¼Œæ¬¢è¿issueäº¤æµï¼ğŸ¤¯ğŸ¤¯ğŸ¤¯


ä¹Ÿæ¬¢è¿åŠ å…¥ **PasteMDä½¿ç”¨äº¤æµç¾¤** ä¸å…¶ä»–ç”¨æˆ·äº¤æµï¼š
<div align="center">
  <img src="docs/img/qrcode.jpg" alt="PasteMDäº¤æµç¾¤äºŒç»´ç " width="200" />
  <br>
  <sub>æ‰«ç åŠ å…¥PasteMD QQäº¤æµç¾¤</sub>
</div>

å¸Œæœ›è¿™ä¸ªå°å·¥å…·å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯·ä½œè€…ğŸ‘»å–æ¯å’–å•¡â˜•ï½ä½ çš„æ”¯æŒä¼šè®©æˆ‘æ›´æœ‰åŠ¨åŠ›æŒç»­ä¿®å¤é—®é¢˜ã€å®Œå–„åŠŸèƒ½ã€é€‚é…æ›´å¤šåœºæ™¯å¹¶ä¿æŒé•¿æœŸç»´æŠ¤ã€‚æ„Ÿè°¢æ¯ä¸€ä»½æ”¯æŒï¼

<img src="docs/gif/atri/flower.gif"
     alt="é€ä½ ä¸€æœµå°èŠ±"
     width="150">
     
| æ”¯ä»˜å® | å¾®ä¿¡ |
| --- | --- |
| ![æ”¯ä»˜å®æ‰“èµ](docs/pay/Alipay.jpg) | ![å¾®ä¿¡æ‰“èµ](docs/pay/Weixinpay.png) |


---

## License

This project is licensed under the [MIT License](LICENSE).
Third-party licenses are listed in [THIRD_PARTY_NOTICES.md](THIRD_PARTY_NOTICES.md).
